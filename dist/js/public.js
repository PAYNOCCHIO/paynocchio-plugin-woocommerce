(()=>{"use strict";(e=>{const a=a=>{e(`${a} > div.visible`).fadeOut("fast",(function(){e(`${a} > div:not(.visible)`).fadeIn("fast"),e(`${a} > div`).toggleClass("visible")}))},o=a=>{a.preventDefault(),e("#user_login").val()||e("#user_email").val()?e.ajax({url:paynocchio_object.ajaxurl,type:"POST",data:{action:"paynocchio_ajax_registration","ajax-registration-nonce":e("#ajax-registration-nonce").val(),login:e("#user_login").val(),email:e("#user_email").val()},success:function(a){console.log(a),a.success?e("#register_messages").text("Please check your email to confirm registration."):"Sorry, that email address is already used!"===a.data.message?e("#register_messages").html("<p>Sorry, this email address is already registered.</p><p>Please <a style='color:#0c88b4' href='/account'>log in</a> or <a style='color:#0c88b4' href='/account'>restore password</a>.</p><p>For any case please <a style='color:#0c88b4' href='mailto:support@kopybara.com'>contact support</a>.</p>"):e("#register_messages").text(a.data.message)},error:e=>console.log(e)}):e("#register_messages").text("Email and login are required")},t=(a,o)=>{e(a.target).addClass("cfps-disabled"),e(`#${a.target.id} .cfps-spinner`).removeClass("cfps-hidden"),e.ajax({url:paynocchio_object.ajaxurl,type:"POST",data:{action:"paynocchio_ajax_activation","ajax-activation-nonce":e("#ajax-activation-nonce").val()},success:function(a){a.success?(e("#response_message").text("Activation processing"),o?document.location.href=o:document.location.reload()):e("#response_message").text(JSON.parse(a.response.response).detail)}}).always((function(){e(`#${a.target.id} .cfps-spinner`).addClass("cfps-hidden"),e(a.target).removeClass("cfps-disabled")})).error((e=>console.log(e.response)))};e(document).ready((function(){e("#wp-submit-registration").click((e=>o(e)));const s="/checkout/?activated=1"===window.location.pathname,c=e("#paynocchio_activation_button");s||c.click((e=>t(e))),e(".form-toggle-a").click((()=>a("#login-signup-forms"))),e("form.checkout").on("change",'input[name="payment_method"]',(function(){e(document.body).trigger("update_checkout")})),e(document).on("updated_checkout",(function(){e("#wp-submit-registration").click((e=>o(e)));const s=e("#paynocchio_auth_block").length,c=e("#place_order"),i=e(".payment_box.payment_method_paynocchio").is(":hidden"),n=e(".payment_box.payment_method_paynocchio .paynocchio").length;c&&!i&&(n&&(c.addClass("cfps-disabled"),c.text("Please activate the Wallet first")),s&&(c.addClass("cfps-disabled"),c.text("Please login or register"))),e("#paynocchio_activation_button").click((e=>t(e))),e(".form-toggle-a").click((()=>a("#login-signup-forms"))),function(e,a=window.location.href){e=e.replace(/[\[\]]/g,"\\$&");const o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(a);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}("ans")&&e(".woocommerce-notices-wrapper:first-child").prepend('<div class="woocommerce-message" role="alert">Registration complete. Please check your email, then visit this page again.</div>')}))}))})(jQuery)})();